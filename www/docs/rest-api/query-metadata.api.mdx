---
id: query-metadata
title: "Query across metadata fields in a corpus"
description: "Query for documents in a specific corpus using fuzzy matching across specified metadata fields. The search first applies any exact metadata filters to narrow the results, then performs fuzzy matching on the remaining documents using the specified field queries."
sidebar_label: "Query across metadata fields in a corpus"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/rest-api/vectara-rest-api-v-2
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Query across metadata fields in a corpus"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/v2/corpora/{corpus_key}/metadata_query"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Query for documents in a specific corpus using fuzzy matching across specified metadata fields. The search first applies any exact metadata filters to narrow the results, then performs fuzzy matching on the remaining documents using the specified field queries.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={[{"in":"header","name":"Request-Timeout","description":"The API will make a best effort to complete the request in the specified seconds or time out.","schema":{"type":"integer","minimum":1},"required":false},{"in":"header","name":"Request-Timeout-Millis","description":"The API will make a best effort to complete the request in the specified milliseconds or time out.","schema":{"type":"integer","minimum":1}},{"in":"path","name":"corpus_key","description":"The unique key identifying the corpus to search for metadata.","required":true,"schema":{"description":"A user-provided key for a corpus.","type":"string","example":"my-corpus","pattern":"[a-zA-Z0-9_\\=\\-]+$","maxLength":50,"title":"CorpusKey"}}]}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","description":"Defines parameters for fuzzy searching across metadata fields in a corpus.","properties":{"level":{"type":"string","enum":["document","part"],"default":"document","description":"Whether to search document-level or part-level metadata. Document-level returns unique documents, part-level can return multiple parts from the same document."},"queries":{"type":"array","description":"List of field-specific queries to apply fuzzy matching.","items":{"type":"object","description":"Defines a field-specific query for fuzzy matching.","properties":{"field":{"type":"string","description":"Name of the metadata field to search (without doc/part prefix)."},"query":{"type":"string","description":"The text to search for in this field. Fuzzy matching is applied automatically."},"weight":{"type":"number","format":"float","description":"Weight to apply to this field during scoring (higher values increase importance of this field).","default":1},"fuzzy":{"type":"boolean","default":true,"description":"Whether to apply fuzzy matching for typo tolerance."},"prefix":{"type":"integer","minimum":1,"default":3,"nullable":true,"description":"Minimum query length to enable prefix matching. Set to null to disable prefix matching. Prefix matching allows finding documents where the field value starts with the query text."}},"required":["field","query"],"title":"FieldQuery"},"example":[{"field":"title","query":"lease agreement","weight":2},{"field":"category","query":"contract","weight":1}]},"metadata_filter":{"description":"Optional filter expression to narrow down results before fuzzy matching is applied. \nThis uses the same expression format as document listing filters and applies exact matching.\n","type":"string","example":"doc.Status = 'Active'"},"limit":{"description":"Sets the maximum number of documents to return.","type":"integer","minimum":1,"maximum":100,"default":10},"offset":{"description":"Starting position for pagination.","type":"integer","minimum":0,"default":0}},"required":["queries"],"title":"MetadataQueryRequest"}}}}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"List of matching documents with relevance scores and field-level match details.","content":{"application/json":{"schema":{"type":"object","description":"Returns document search results with relevance scores.","properties":{"documents":{"type":"array","description":"Matched documents ordered by relevance score (highest first).","items":{"type":"object","description":"A document with its relevance score and metadata.","properties":{"doc_id":{"description":"The document ID.","type":"string","example":"document123"},"score":{"description":"The overall relevance score for this document.","type":"number","format":"float","example":0.92},"metadata":{"description":"Document metadata object containing all document metadata fields.","type":"object","additionalProperties":true}},"title":"ScoredDocument"}},"total_count":{"type":"integer","description":"Total number of matching documents (for pagination).","example":42}},"title":"MetadataQueryResponse"}}}},"400":{"description":"Metadata query request was malformed.","content":{"application/json":{"schema":{"description":"Error returned when a request contains invalid parameters or violates schema validation.","type":"object","properties":{"field_errors":{"description":"The errors that relate to specific fields in the request.","type":"object","additionalProperties":{"type":"string"}},"messages":{"type":"array","items":{"title":"message","type":"string"}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"BadRequestError"}}}},"403":{"description":"Permissions do not allow querying metadata in the corpus.","content":{"application/json":{"schema":{"description":"A general error response with an error code and message.","type":"object","properties":{"messages":{"description":"The messages describing why the error occurred.","type":"array","items":{"title":"message","type":"string","example":"Internal server error."}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"Error"}}}},"404":{"description":"Corpus not found.","content":{"application/json":{"schema":{"description":"Error returned when a requested resource does not exist.","type":"object","properties":{"id":{"description":"The ID cannot be found.","type":"string"},"messages":{"type":"array","items":{"title":"message","type":"string"}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"NotFoundError"}}}}}}
>
  
</StatusCodes>


      